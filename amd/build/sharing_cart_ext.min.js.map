{"version":3,"sources":["../src/sharing_cart_ext.js"],"names":["init","document","addEventListener","addToBasketCB","event","$","iconPromise","currentTarget","courseid","querySelector","dataset","parentId","post","config","wwwroot","target","parentElement","moduleId","sesskey","then","response","replaceWith","init_item_tree","resolve","querySelectorAll","forEach","element","onclick"],"mappings":"2LAoBA,OACA,O,0DAGoB,QAAPA,CAAAA,IAAO,EAAM,CACtBC,QAAQ,CAACC,gBAAT,CAA0B,gCAA1B,CAA4D,UAAM,CAC9D,GAAMC,CAAAA,CAAa,CAAG,SAACC,CAAD,CAAW,CAC7B,GAAIC,SAAJ,CAAO,IAEGC,CAAAA,CAAW,CAAG,oCAA8BF,CAAK,CAACG,aAApC,CAFjB,CAGGC,CAAQ,CAAGP,QAAQ,CAACQ,aAAT,CAAuB,oCAAvB,EAA6DC,OAA7D,CAAqEC,QAHnF,CAIHN,UAAEO,IAAF,CAAOC,UAAOC,OAAP,CAAiB,+BAAxB,CAAyD,CACrD,OAAU,QAD2C,CAErD,KAAQV,CAAK,CAACW,MAAN,CAAaC,aAAb,CAA2BN,OAA3B,CAAmCO,QAFU,CAGrD,WAHqD,CAIrD,QAAWJ,UAAOK,OAJmC,CAKrD,SAAYV,CALyC,CAAzD,EAMGW,IANH,CAMQ,UAAM,CACVd,UAAEO,IAAF,CAAOC,UAAOC,OAAP,CAAiB,+BAAxB,CACI,CACI,OAAU,aADd,CAEI,SAAYN,CAFhB,CADJ,CAKI,SAAUY,CAAV,CAAoB,CAChB,cAAE,2BAAF,EAA+BC,WAA/B,CAA2C,cAAED,CAAF,CAA3C,EACAf,UAAEiB,cAAF,EACH,CARL,CAQO,MARP,EASAhB,CAAW,CAACiB,OAAZ,EACH,CAjBD,CAkBH,CACJ,CAxBD,CAyBAtB,QAAQ,CAACuB,gBAAT,CAA0B,iDAA1B,EAA6EC,OAA7E,CACI,SAACC,CAAD,CAAa,CACTA,CAAO,CAACC,OAAR,CAAkBxB,CACrB,CAHL,CAKH,CA/BD,CAgCH,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * A javascript module\n *\n */\n\nimport $ from 'jquery';\nimport config from 'core/config';\nimport {addIconToContainerWithPromise} from 'core/loadingicon';\n\nexport const init = () => {\n    document.addEventListener('resource_library_card_rendered', () => {\n        const addToBasketCB = (event) => {\n            if ($) {\n                // Create a spinning icon on the card.\n                const iconPromise = addIconToContainerWithPromise(event.currentTarget);\n                const courseid = document.querySelector('.local-resourcelibrary.block-cards').dataset.parentId;\n                $.post(config.wwwroot + '/blocks/sharing_cart/rest.php', {\n                    \"action\": \"backup\",\n                    \"cmid\": event.target.parentElement.dataset.moduleId,\n                    \"userdata\": false,\n                    \"sesskey\": config.sesskey,\n                    \"courseid\": courseid\n                }).then(() => {\n                    $.post(config.wwwroot + '/blocks/sharing_cart/rest.php',\n                        {\n                            \"action\": \"render_tree\",\n                            \"courseid\": courseid\n                        },\n                        function (response) {\n                            $('.block_sharing_cart .tree').replaceWith($(response));\n                            $.init_item_tree();\n                        }, \"html\");\n                    iconPromise.resolve();\n                });\n            }\n        };\n        document.querySelectorAll('.resource-library-activities .sharing-cart-icon').forEach(\n            (element) => {\n                element.onclick = addToBasketCB;\n            }\n        );\n    });\n};\n"],"file":"sharing_cart_ext.min.js"}